POP_LDFLAGS += -L$(top_builddir)/pop -lpop

LEX_SOURCES = test_lexer.cpp
LEX_OBJECTS = $(addprefix $(builddir)/,$(LEX_SOURCES:.cpp=.o))
LEX_DEPENDS = $(addprefix $(builddir)/,$(LEX_SOURCES:.cpp=.d))

DEPENDS = $(LEX_DEPENDS)

all: test_lexer

clean:
	$(RM) *.o *.d test_lexer

test_lexer: $(LEX_OBJECTS) $(top_builddir)/pop/libpop.so
	$(strip $(POP_CXXLD) $(POP_CXXFLAGS) -o $@ $(LEX_OBJECTS) $(POP_LDFLAGS))

$(builddir)/%.o: $(srcdir)/%.cpp
	$(strip $(POP_CXX) $(POP_CXXFLAGS) -o $@ $<)

$(top_builddir)/pop/libpop.so:
	$(MAKE) -C $(top_builddir)/pop libpop.so
